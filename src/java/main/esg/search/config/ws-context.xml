<?xml version="1.0" encoding="UTF-8"?>
<!-- Spring context configuration for search web services -->
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:context="http://www.springframework.org/schema/context"
	   xmlns:p="http://www.springframework.org/schema/p"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">
                           
    <!-- enable support for annotation-based URL resolution -->
    <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping"/>
    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"/>
    <bean class="org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter"/>
    
   	<!-- URLs configuration -->
	<bean id="urlMappings" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
	    <property name="order" value="1" />
		<property name="mappings">
			<props>
			
				<!-- Publishing Web Services -->
				<prop key="/remote/hessian/publish/">publishingWebService</prop>
				
				<!-- legacy URL -->
				<prop key="/remote/secure/client-cert/hessian/publishingService">legacyPublishingWebService</prop>
				
				<!-- Search Web Service
				<prop key="/remote/hessian/search/">searchWebService</prop> -->
				
				<!-- Search Rest Controller -->
				<prop key="/ws/rest/search/">searchRestController</prop>
												
			</props>
		</property>
	</bean>
	
	<!-- View resolver is only used for RSS feeds -->
	<bean class="org.springframework.web.servlet.view.BeanNameViewResolver"/>

	<!-- Publishing Web Service -->
    <bean name="publishingWebService" class="org.springframework.remoting.caucho.HessianServiceExporter">
        <property name="service">
            <ref bean="publishingService"/>
        </property>
        <property name="serviceInterface">
            <value>esg.search.publish.api.PublishingService</value>
        </property>
    </bean> 
    
    <!-- RSS Views -->
    <bean id="datasetsRssView" class="esg.search.feed.web.DatasetsRssView" p:properties-ref="esgfProperties"/>
    <bean id="filesRssView" class="esg.search.feed.web.FilesRssView" p:properties-ref="esgfProperties"/>
    <bean id="esgfProperties" class="esg.common.util.ESGFProperties" />
          
    <!-- Legacy Publishing Web Service -->
    <bean name="legacyPublishingWebService" class="org.springframework.remoting.caucho.HessianServiceExporter">
        <property name="service">
            <ref bean="legacyPublishingService"/>
        </property>
        <property name="serviceInterface">
            <value>esg.search.publish.api.LegacyPublishingService</value>
        </property>
    </bean>

</beans>
